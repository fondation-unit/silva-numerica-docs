"use strict";(self.webpackChunksilva_numerica_docs=self.webpackChunksilva_numerica_docs||[]).push([[9805],{6226:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>a});var t=i(5893),r=i(1151);const c={sidebar_position:2},l="Authentification Device Flow",s={id:"authentification/authentification-device-flow",title:"Authentification Device Flow",description:"1. Requ\xeate d'autorisation de client",source:"@site/docs/authentification/authentification-device-flow.md",sourceDirName:"authentification",slug:"/authentification/authentification-device-flow",permalink:"/silva-numerica-docs/docs/authentification/authentification-device-flow",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Authentification OAuth2",permalink:"/silva-numerica-docs/docs/authentification/authentification-oauth2"},next:{title:"API",permalink:"/silva-numerica-docs/docs/category/api"}},d={},a=[{value:"1. Requ\xeate d&#39;autorisation de client",id:"1-requ\xeate-dautorisation-de-client",level:2},{value:"Avec cURL :",id:"avec-curl-",level:4},{value:"2. R\xe9cup\xe9ration des informations n\xe9cessaires",id:"2-r\xe9cup\xe9ration-des-informations-n\xe9cessaires",level:2},{value:"3. Lancement d&#39;un polling sur l&#39;URI de token",id:"3-lancement-dun-polling-sur-luri-de-token",level:2},{value:"Avec cURL :",id:"avec-curl--1",level:4},{value:"Interpr\xeater les r\xe9sultats :",id:"interpr\xeater-les-r\xe9sultats-",level:4},{value:"4. Affichage de l&#39;interface de confirmation",id:"4-affichage-de-linterface-de-confirmation",level:2},{value:"5. R\xe9cup\xe9rer les informations de l&#39;utilisateur",id:"5-r\xe9cup\xe9rer-les-informations-de-lutilisateur",level:2},{value:"Avec cURL :",id:"avec-curl--2",level:4},{value:"Exemple de r\xe9ponse :",id:"exemple-de-r\xe9ponse-",level:4}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h4:"h4",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"authentification-device-flow",children:"Authentification Device Flow"}),"\n",(0,t.jsx)(n.h2,{id:"1-requ\xeate-dautorisation-de-client",children:"1. Requ\xeate d'autorisation de client"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Requ\xeate"}),(0,t.jsx)(n.th,{children:"URL"}),(0,t.jsx)(n.th,{children:"Param\xe8tres"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"POST"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"[API_URL]/oauth/authorize_device"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"client_id"})})]})})]}),"\n",(0,t.jsx)(n.h4,{id:"avec-curl-",children:"Avec cURL :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[API_URL]/oauth/authorize_device \\\n  -H "Content-Type: application/json" \\\n  --data \'{"client_id": "[REDACTED]"}\'\n'})}),"\n",(0,t.jsx)(n.h2,{id:"2-r\xe9cup\xe9ration-des-informations-n\xe9cessaires",children:"2. R\xe9cup\xe9ration des informations n\xe9cessaires"}),"\n",(0,t.jsx)(n.p,{children:"R\xe9cup\xe9rer \xe0 minima :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"device_code"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"verification_uri_complete"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"3-lancement-dun-polling-sur-luri-de-token",children:"3. Lancement d'un polling sur l'URI de token"}),"\n",(0,t.jsx)(n.p,{children:"Lancer une requ\xeate r\xe9p\xe9t\xe9e \xe0 l'intervale renvoy\xe9e par la r\xe9ponse de l'\xe9tape 2 (toutes les 5 secondes par d\xe9faut)."}),"\n",(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Requ\xeate"}),(0,t.jsx)("th",{children:"URL"}),(0,t.jsx)("th",{children:"Param\xe8tre"}),(0,t.jsx)("th",{children:"Valeur"})]})}),(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{rowspan:"3",children:"POST"}),(0,t.jsx)("td",{rowspan:"3",children:(0,t.jsx)(n.code,{children:"[API_URL]/oauth/token"})}),(0,t.jsx)("td",{children:(0,t.jsx)(n.code,{children:"grant_type"})}),(0,t.jsx)("td",{children:(0,t.jsx)(n.code,{children:"urn:ietf:params:oauth:grant-type:device_code"})})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(n.code,{children:"device_code"})}),(0,t.jsx)("td",{children:(0,t.jsx)(n.code,{children:"[REDACTED]"})})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(n.code,{children:"client_id"})}),(0,t.jsx)("td",{children:(0,t.jsx)(n.code,{children:"[REDACTED]"})})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"avec-curl--1",children:"Avec cURL :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://[API_URL]/oauth/token \\\n  -H "Content-Type: application/json" \\\n  --data \'{"grant_type": "urn:ietf:params:oauth:grant-type:device_code", "device_code": "[REDACTED]", "client_id": "[REDACTED]"}\'\n'})}),"\n",(0,t.jsx)(n.h4,{id:"interpr\xeater-les-r\xe9sultats-",children:"Interpr\xeater les r\xe9sultats :"}),"\n",(0,t.jsx)(n.p,{children:"Un polling avec succ\xe8s retournera les informations suivantes :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'{\n  "access_token": "[REDACTED]",\n  "token_type": "Bearer",\n  "expires_in": 7200,\n  "refresh_token": "[REDACTED]",\n  "scope": "read",\n  "created_at": 1707128830\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["R\xe9cup\xe9rer ",(0,t.jsx)(n.code,{children:"access_token"})," pour authentifier l'utilisateur"]}),"\n",(0,t.jsx)(n.h2,{id:"4-affichage-de-linterface-de-confirmation",children:"4. Affichage de l'interface de confirmation"}),"\n",(0,t.jsxs)(n.p,{children:["Ouvrir un navigateur sur l'URL ",(0,t.jsx)(n.code,{children:"verification_uri_complete"})," fournie en r\xe9ponse \xe0 l'\xe9tape 2."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"L'utilisateur d\xe9j\xe0 authentifi\xe9 devra valider le code pr\xe9-compl\xe9t\xe9 en cliquant sur le bouton."}),"\n",(0,t.jsx)(n.li,{children:"L'utilisateur non-authentifi\xe9 devra se connecter \xe0 son compte puis valider la connexion en cliquant sur le bouton."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"La validation avec succ\xe8s par l'utilisateur d\xe9clenche la r\xe9ception des informations attendues par le polling de l'\xe9tape 3."}),"\n",(0,t.jsx)(n.h2,{id:"5-r\xe9cup\xe9rer-les-informations-de-lutilisateur",children:"5. R\xe9cup\xe9rer les informations de l'utilisateur"}),"\n",(0,t.jsxs)(n.p,{children:["\xc9mettre une requ\xeate GET avec le Bearer token correspondant \xe0 la valeur ",(0,t.jsx)(n.code,{children:"access_token"})," r\xe9cup\xe9r\xe9e par le polling de l'\xe9tape 3."]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Requ\xeate"}),(0,t.jsx)(n.th,{children:"URL"}),(0,t.jsx)(n.th,{children:"Headers"}),(0,t.jsx)(n.th,{children:"Valeur"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GET"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"[API_URL]/api/v1/me"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Authorization"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Bearer [REDACTED]"})})]})})]}),"\n",(0,t.jsx)(n.h4,{id:"avec-curl--2",children:"Avec cURL :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl https://[API_URL]/api/v1/me \\\n  -H "Authorization: Bearer [REDACTED]"\n'})}),"\n",(0,t.jsx)(n.h4,{id:"exemple-de-r\xe9ponse-",children:"Exemple de r\xe9ponse :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'{\n  "user": {\n    "id": 10,\n    "firstname": "John",\n    "lastname": "Doe",\n    "email": "johndoe@localhost.com",\n    "created_at": "2024-02-13T09:00:00.389Z"\n  }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);